""" 
To do:
Setup leaderboard of event counts
Flag risky logins
Set logon hours?

"""


import os

file = 'logs.txt'

def parse_logs(file):
    
    failed_logins = dict()
    successful_logins = dict()
    file_access = dict()
    logoff = dict()
    with open(file, 'r') as f:
        for line in f:
            parts = line.strip().split(',')
            time = parts[0]
            user = parts[1]
            ip = parts[2]
            event = parts[3]
            match event:
                case 'LOGON':
                    successful_logins[user] = successful_logins.get(user, 0) + 1
                case 'LOGON_FAILED':
                    failed_logins[user] = failed_logins.get(user, 0) + 1
                case 'LOGOFF':
                    logoff[user] = logoff.get(user, 0) + 1
                case 'FILE_ACCESS':
                    file_access[user] = file_access.get(user, 0) + 1
    
    sorted_failed = dict(sorted(failed_logins.items(), key=lambda x: x[1], reverse=True))
    
    for u, count in sorted_failed.items():
        print(f'{u} had {count} failed logins')
                    


parse_logs(file)